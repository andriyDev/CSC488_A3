Andriy Dzikh (dzikhand): Implemented the code generation.
